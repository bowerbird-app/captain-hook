<!DOCTYPE html>
<html class="h-full">
  <head>
    <title>CaptainHook Admin</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Tailwind CSS with FlatPack styles -->
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "captain_hook/variables", "data-turbo-track": "reload" %>
    
    <!-- JavaScript -->
    <%= javascript_importmap_tags if respond_to?(:javascript_importmap_tags) %>
    
    <%= yield :head %>
  </head>

  <body class="h-full bg-gray-50">
    <%= render FlatPack::Navbar::Component.new(class: "h-screen bg-gray-900") do |navbar| %>
      <% navbar.top_nav do |nav| %>
        <% nav.left_section do %>
          <div class="flex items-center gap-6">
            <%= link_to captain_hook.admin_root_path, class: "text-xl font-semibold" do %>
              âš“ CaptainHook
            <% end %>
            <div class="flex gap-2">
              <%= render FlatPack::Button::Component.new(
                text: "Providers",
                url: captain_hook.admin_providers_path,
                style: controller_name == 'providers' ? :primary : :ghost,
                size: :sm
              ) %>
              <%= render FlatPack::Button::Component.new(
                text: "Incoming Events",
                url: captain_hook.admin_incoming_events_path,
                style: controller_name == 'incoming_events' ? :primary : :ghost,
                size: :sm
              ) %>
              <%= render FlatPack::Button::Component.new(
                text: "Sandbox",
                url: captain_hook.admin_sandbox_path,
                style: controller_name == 'sandbox' ? :primary : :ghost,
                size: :sm
              ) %>
            </div>
          </div>
        <% end %>
      <% end %>

      <!-- Flash Messages -->
      <% if flash.any? %>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
          <% flash.each do |type, message| %>
            <% 
              alert_style = case type.to_s
              when 'notice' then :primary
              when 'alert', 'error' then :danger
              when 'warning' then :warning
              when 'success' then :success
              else :primary
              end
            %>
            <%= render FlatPack::Alert::Component.new(
              style: alert_style,
              class: "mb-4"
            ) do %>
              <%= simple_format(message, {}, wrapper_tag: "div", sanitize: false) %>
            <% end %>
          <% end %>
        </div>
      <% end %>

      <!-- Main Content -->
      <%= yield %>
    <% end %>
  </body>
</html>
