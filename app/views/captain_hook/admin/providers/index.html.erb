<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-4">
  <div class="mb-6">
    <h1 class="text-xl font-bold text-gray-900">Webhook Providers</h1>
  </div>

  <% if @providers.any? %>
    <%= render FlatPack::Table::Component.new(data: @providers) do |table| %>
      <% table.column(title: "Name", html: ->(provider) { provider.name }) %>
      <% table.column(title: "Name", html: ->(provider) { CaptainHook.configuration.provider(provider.name)&.display_name || provider.name.titleize }) %>
      
      <% table.column(title: "Status", html: ->(provider) {
        db_provider = @db_providers[provider.name]
        if db_provider&.active?
          '<span class="text-green-600 font-medium">Active</span>'.html_safe
        else
          '<span class="text-gray-500">Inactive</span>'.html_safe
        end
      }) %>
      
      <% table.column(title: "Security", html: ->(provider) {
        provider_config = CaptainHook.configuration.provider(provider.name)
        if provider_config&.verifier_class.present?
          '<span class="text-green-600 font-medium">Enabled</span>'.html_safe
        else
          '<span class="text-gray-500">None</span>'.html_safe
        end
      }) %>
      
      <% table.column(title: "Actions", html: ->(provider) {
        db_provider = @db_providers[provider.name]
        if db_provider
          link_to(db_provider.actions.count, admin_provider_actions_path(db_provider))
        else
          '0'
        end
      }) %>
      
      <% table.with_action(
        text: "View",
        url: ->(provider) { 
          db_provider = @db_providers[provider.name]
          db_provider ? url_for([:admin, db_provider]) : nil
        }
      ) %>
    <% end %>
  <% else %>
    <div class="alert alert-info">
      <p class="mb-2"><strong>No providers configured yet.</strong></p>
      <p class="mb-0">Providers are automatically discovered from YAML files in the <code>captain_hook/&lt;provider&gt;/&lt;provider&gt;.yml</code> directory on application boot. Create a provider YAML file and restart the server to add providers.</p>
    </div>
  <% end %>
</div>
